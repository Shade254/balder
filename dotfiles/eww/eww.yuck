;; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
;;  Â°Ë–* à«®(  â€¢ á´— ï½¡)ã£ðŸ¸  Balder EWW Dashboard
;;  EWW HUD config for Hyprland
;;  Version 1.0
;; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

;; === Window Includes â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(include "windows/sys/four_boxes.yuck")
(include "windows/sys/workspace_window_text.yuck")
(include "windows/bar/cpu_ram_storage_bars.yuck")
(include "windows/sys/power_cooling_header_text.yuck")
(include "windows/sys/power_mode_text.yuck")
(include "windows/sys/right_fan_data.yuck")
(include "windows/net/ascii_decor_frame.yuck")
(include "windows/net/net_bars.yuck")
(include "windows/net/right_internet_text.yuck")
(include "windows/misc/welcome_text.yuck")

;; === Variables â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(defvar max_fan_rpm "5000")

(defvar ascii_decor1 "
-                                                 -
--                                               --
-                                                 -
--                                               --
-                                                 -
--                                               --
-                                                 -
--                                               --
-                                                 -
--                                               --
-                                                 -
")

;; === Workspace Status â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
;; Workspace display consolidated into workspace_window_text using reactor_core_layout
;; which shows Cyrillic letters (Ð, Ð‘, Ð’, Ð“) for workspaces 1-4, numbers for 5+

;; === Power & Voltage â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(defpoll gpu_voltage :interval "5s"
  "bash ~/.config/eww/scripts/sys/sys_gpu_voltage.sh || echo 'null'")
(defpoll cpu_voltage :interval "5s"
  "bash ~/.config/eww/scripts/sys/sys_cpu_voltage.sh || echo 'null'")
(defpoll dc_voltage :interval "10s"
  "bash ~/.config/eww/scripts/sys/sys_dc_voltage.sh || echo 'null'")
(defpoll power_mode :interval "10s"
  "bash ~/.config/eww/scripts/sys/sys_power_mode.sh || echo 'null'")
(defpoll power_draw :interval "5s"
  "sensors | grep -m 1 'power1:' | awk '{print $2 \" \"$3}' || echo 'N/A'")

;; === CPU & GPU Stats â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(defpoll cpu :interval "10m"
  "lscpu | grep 'Model name' | cut -d ':' -f2 | xargs || echo 'null'")
(defpoll gpu :interval "10m"
  "lspci | grep -i vga | cut -d ':' -f3 || echo 'null'")

(defpoll cpu_usage :interval "2s"
  "top -bn1 | grep 'Cpu(s)' | awk '{print int($2 + $4)}' || echo 'null'")
(defpoll cpu_bar :interval "2s"
  "bash ~/.config/eww/scripts/bar/bar_render.sh $(top -bn1 | grep 'Cpu(s)' | awk '{print int($2 + $4)}') || echo 'null'")

;; T2 Mac: No discrete GPU, using Intel Iris Plus 655 iGPU
(defpoll gpu_usage :interval "2s" "echo 'iGPU'")

;; T2 Mac: coretemp for CPU, pch_cannonlake for chipset
(defpoll cpu_temp :interval "5s"
  "sensors | grep 'Package id 0' | awk '{print $4}' || echo 'N/A'")
(defpoll gpu_temp :interval "5s"
  "sensors | grep -A2 'pch_cannonlake' | grep 'temp1' | awk '{print $2}' || echo 'N/A'")

;; T2 Mac: fan1 = Left fan, fan2 = Right fan (no CPU/GPU fan distinction)
(defpoll cpu_fan_rpm :interval "5s"
  "sensors | grep -E '^fan1:' | awk '{print $2 \" RPM\"}' || echo 'null'")
(defpoll gpu_fan_rpm :interval "5s"
  "sensors | grep -E '^fan2:' | awk '{print $2 \" RPM\"}' || echo 'null'")

;; Fan ASCII spinners - T2 Mac: left fan (fan1) and right fan (fan2)
(defpoll cpu_fan_ascii :interval "0.2s"
  "bash ~/.config/eww/scripts/sys/sys_fan_spin.sh left || echo 'null'")
(defpoll gpu_fan_ascii :interval "0.2s"
  "bash ~/.config/eww/scripts/sys/sys_fan_spin.sh right || echo 'null'")

;; === Memory & Storage â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(defpoll ram_info :interval "5s"
  "free -h | awk '/Mem:/ {print $3\" / \"$2}' || echo 'null'")
(defpoll ram_percent :interval "5s"
  "free | awk '/Mem:/ {printf \"%d\", $3/$2 * 100}' || echo 'null'")
(defpoll ram_bar :interval "5s"
  "bash ~/.config/eww/scripts/bar/bar_render.sh $(free | awk '/Mem:/ {printf(\"%.0f\", $3/$2 * 100)}') || echo 'null'")
(defpoll ram :interval "5s"
  "free -h | awk '/Mem:/ {print $3 \"/\" $2}' || echo 'null'")

(defpoll disk :interval "10s"
  "df -h / | awk 'NR==2 {print $3 \"/\" $2}' || echo 'null'")
(defpoll storage_percent :interval "5s"
  "df / | awk 'NR==2 {print int($3*100/$2)}' || echo 'null'")
(defpoll storage_bar :interval "5s"
  "bash ~/.config/eww/scripts/bar/bar_render.sh $(df / | awk 'NR==2 {print int($3*100/$2)}') || echo 'null'")

;; === Networking â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(defpoll upload_speed :interval "3s"
  "bash ~/.config/eww/scripts/net/net_upload.sh || echo 'null'")
(defpoll upload_bar :interval "3s"
  "bash ~/.config/eww/scripts/net/net_upload.sh | xargs bash ~/.config/eww/scripts/net/net_upload_bar.sh || echo 'null'")

(defpoll download_speed :interval "3s"
  "bash ~/.config/eww/scripts/net/net_download.sh || echo 'null'")
(defpoll download_bar :interval "3s"
  "bash ~/.config/eww/scripts/net/net_download.sh | xargs bash ~/.config/eww/scripts/net/net_download_bar.sh || echo 'null'")

(defpoll ping_ms :interval "5s"
  "bash ~/.config/eww/scripts/net/net_ping.sh || echo 'null'")
(defpoll ping_bar :interval "5s"
  "bash ~/.config/eww/scripts/net/net_ping.sh | xargs bash ~/.config/eww/scripts/net/net_ping_latency.sh || echo 'null'")

(defpoll vpn_status_text :interval "5s"
  "bash ~/.config/eww/scripts/net/net_vpn_status.sh || echo 'null'")
(defpoll vpn_bar :interval "5s"
  "bash ~/.config/eww/scripts/net/net_vpn.sh | xargs bash ~/.config/eww/scripts/net/net_vpn_bar.sh || echo 'null'")

;; === Time & Date â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(defpoll welcome_date :interval "30s"
  "date '+%A, %d %B %Y' || echo 'null'")
(defpoll weekday_str :interval "10s"
  "date +%A || echo 'null'")
(defpoll datetime_str :interval "10s"
  "date '+%H:%M â€¢ %d %B %Y' || echo 'null'")
(defpoll weather_forecast :interval "30m"
  "curl -s 'wttr.in?format=%C+%t' || echo 'N/A'")

;; === System Info â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(defpoll os :interval "10m"
  "uname -o || echo 'null'")
(defpoll desktop :interval "10m"
  "echo $XDG_CURRENT_DESKTOP || echo 'null'")
(defpoll wm :interval "10m"
  "echo $XDG_SESSION_TYPE || echo 'null'")
(defpoll shell :interval "10m"
  "basename $SHELL || echo 'null'")
(defpoll USER :interval "10m"
  "whoami || echo 'null'")

(defpoll install-age :interval "1h"
  "uptime -s | xargs -I{} date -d {} +%s | xargs -I{} echo $(( ($(date +%s) - {}) / 86400 ))' days' || echo 'null'")
(defpoll since-boot :interval "5s"
  "uptime -s || echo 'null'")
(defpoll uptime_full :interval "0.5s"
  "awk '{sec=int($1); ms=substr(sprintf(\"%.3f\", $1 - sec), 3); printf \"%02d:%02d:%02d.%s\\n\", sec/3600, (sec%3600)/60, sec%60, ms}' /proc/uptime || echo 'null'")
(defpoll centered-name :interval "10m"
  "echo $USER@$(hostname) || echo 'null'")

;; Battery charging state (true/false)
;; NOTE: Using grep -qx for EXACT match - 'charging' would also match 'Discharging'!
(defpoll battery_charging :interval "10s"
  "cat /sys/class/power_supply/BAT0/status 2>/dev/null | grep -qix 'charging' && echo 'true' || echo 'false'")

;; Battery time - shows time to full (charging) or time to empty (discharging)
(defpoll battery_time :interval "10s"
  "upower -i $(upower -e | grep BAT) 2>/dev/null | awk '
    /state:/ { state = $2 }
    /time to empty/ { empty = $4 \" \" $5 }
    /time to full/ { full = $4 \" \" $5 }
    END {
      if (state == \"charging\" && full != \"\") print full;
      else if (state == \"discharging\" && empty != \"\") print empty;
      else if (state == \"fully-charged\") print \"FULL\";
      else print \"N/A\"
    }' || echo 'null'")

;; === ASCII Widgets & Feeds â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(defpoll reactor_gen :interval "0.5s"
  "cat /tmp/reactor_frame.txt || echo 'null'")
(defpoll reactor_ascii :interval "0.5s"
  "cat /tmp/reactor_frame.txt || echo 'standby'")

(defpoll reactor_core_layout :interval "1s"
  "bash ~/.config/eww/scripts/ascii/ascii_core_layout.sh && cat /tmp/core_layout.txt || echo 'standby'")

(defpoll live_log_gen :interval "5s"
  "bash ~/.config/eww/scripts/ascii/ascii_live_log.sh || echo 'null'")
(defpoll live_text :interval "5s"
  "cat /tmp/live_text.txt || echo '--------------â€¦'")
